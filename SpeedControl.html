<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BLDC Speed Control</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 400px;
            margin: 40px auto;
        }
        label {
            display: inline-block;
            width: 100px;
        }
        input[type="number"], input[type="text"] {
            width: 150px;
        }
        .buttons button {
            margin: 4px;
            width: 70px;
        }
    </style>
</head>
<body>

    <h1>BLDC Speed Control</h1>

    <div>
        <label for="ip">IP Address:</label>
        <input type="text" id="ip" value="192.168.50.111">
    </div>
    <br>

    <div>
        <label for="speed">Speed:</label>
        <input type="number" id="speed" min="0" max="1023" value="0">
    </div>
    <br>

    <div>
        <input type="range" id="slider" min="0" max="1023" value="0" style="width:100%;">
    </div>
    <br>

    <div class="buttons">
        <button onclick="changeSpeed(1)">+1</button>
        <button onclick="changeSpeed(-1)">-1</button><br>
        <button onclick="changeSpeed(10)">+10</button>
        <button onclick="changeSpeed(-10)">-10</button><br>
        <button onclick="changeSpeed(100)">+100</button>
        <button onclick="changeSpeed(-100)">-100</button>
    </div>

    <script>
        const speedInput = document.getElementById("speed");
        const slider = document.getElementById("slider");

        function clamp(value) {
            return Math.min(1023, Math.max(0, value));
        }

        function sendSpeed(speed) {
            const ip = document.getElementById("ip").value;
            const url = `http://${ip}/?Speed=${speed}`;

            // Fire-and-forget GET request
            fetch(url).catch(() => {});
        }

        function updateSpeed(value) {
            value = clamp(value);
            speedInput.value = value;
            slider.value = value;
            sendSpeed(value);
        }

        function changeSpeed(delta) {
            updateSpeed(parseInt(speedInput.value) + delta);
        }

        speedInput.addEventListener("change", () => {
            updateSpeed(parseInt(speedInput.value));
        });

        slider.addEventListener("input", () => {
            updateSpeed(parseInt(slider.value));
        });
    </script>

</body>
</html>
